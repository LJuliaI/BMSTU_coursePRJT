

$( document ).ready(function () {
floor (2);

$('.wrap1-btn3').click(function () {
	cleardata ("floor");
	floor (3);
});
$('.wrap1-btn2').click(function () {
	cleardata ("floor");
	floor (2);
});
});
function mouseinf(){
		$('.description').html($(this).attr('description-data'));
		$('.description').fadeIn(5);
}
function mouseoutf(){
		$('.description').fadeOut(5);
}
function cleardata(elementID){
	document.getElementById(elementID).innerHTML = "";
}

function floor (etaz){
	var frm = document.forms.change_floor;
	var param_str = "?" +"etaz=" + etaz
//	if (param_str == "") return false;
	var my_JSON_object = {};
	var link = location.protocol + "//" + location.host + "/map/getdata.json"
	var http_request = new XMLHttpRequest();
	http_request.open("GET", link+param_str, true);
	http_request.onreadystatechange = function () {
		var done = 4, ok = 200;
		if (http_request.readyState == done &&
			http_request.status == ok) {
				my_JSON_object = JSON.parse(http_request.responseText);
				show_result(my_JSON_object, etaz);
		}
	};
		http_request.send(null);
		return false;
	}
	function show_result(data, flor){
		var newsvg = document.createElementNS("http://www.w3.org/2000/svg","svg");
		newsvg.className = "svg-btn2";
		newsvg.setAttribute('viewBox', "0 0 1382.6667 974.66669");
		data.forEach(function(rowData) {
			var newpth = document.createElementNS("http://www.w3.org/2000/svg","path");
			newpth.setAttribute('d', rowData["coord"]);
			newpth.setAttribute('description-data', rowData["name"]);
			newpth.setAttribute('fill', "#82befa");
			newpth.setAttribute('class', "part");
			newpth.addEventListener("mouseover", mouseinf);
			newpth.addEventListener("mouseout", mouseoutf);
			newsvg.appendChild(newpth);
		});
		document.getElementById("floor").appendChild(newsvg);
		var newimg = document.createElement("img");
		switch (flor) {
			case 2:
				newimg.setAttribute('src', "/images/bmstu2floorimg.jpg");
				break;
			case 3:
				newimg.setAttribute('src', "/images/bmstu3floor.jpg");
				break;
			 }
		document.getElementById("floor").appendChild(newimg);
	}
